DROP PROCEDURE IF EXISTS `invdb`.`audit_all_user_trade_profile`;

DELIMITER $$
CREATE PROCEDURE `invdb`.`audit_all_user_trade_profile`(
	IN	p_acctnum	bigint(20)
)
BEGIN 

	BEGIN
		INSERT INTO  `invdbaudit`.`user_trade_profile` (
			`acctnum`,
			`advisor`,
			`rep`,
			`theme`,
			`firstname`,
			`lastname`,
			`portfolioName`,
			`goal`,
			`acctType`,
			`age`,
			`horizon`,
			`initialInvestment`,
			`recurringInvestment`,
			`experience`,
			`longTermGoal`,
			`stayInvested`,
			`charitablegoals`,
			`dependent`,
			`riskIndex`,
			`tradePreference`,
			`keepLiquid`,
			`taxable`,
			`calcModel`,
			`assetIndex`,
			`portfolioIndex`,
			`goalAmount`,
			`email`,
			`ip`,
			`created`,
			`lastUpdated`,
			`managed`,
			`clientAccountID`)
            
			select `acctnum`,
			`advisor`,
			`rep`,
			`theme`,
			`firstname`,
			`lastname`,
			`portfolioName`,
			`goal`,
			`acctType`,
			`age`,
			`horizon`,
			`initialInvestment`,
			`recurringInvestment`,
			`experience`,
			`longTermGoal`,
			`stayInvested`,
			`charitablegoals`,
			`dependent`,
			`riskIndex`,
			`tradePreference`,
			`keepLiquid`,
			`taxable`,
			`calcModel`,
			`assetIndex`,
			`portfolioIndex`,
			`goalAmount`,
			`email`,
			`ip`,
			`created`,
			now(),
			`managed`,
			`clientAccountID` 
            from  `invdb`.`user_trade_profile` 
            where `user_trade_profile`.`acctnum` = p_acctnum ;
	END;
    
    BEGIN
		INSERT INTO `invdbaudit`.`user_risk_questions`
				(`acctnum`,
				`investmentgoal`,
				`age`,
				`retireage`,
				`retired`,
				`horizon`,
				`ans1`,
				`ans2`,
				`ans3`,
				`ans4`,
				`ans5`,
				`ans6`,
				`ans7`,
				`ans8`,
				`ans9`,
				`ans10`,
				`ans11`,
				`ans12`,
				`ans13`,
				`ans14`,
				`ans15`,
				`formula`,
				`risk1`,
				`risk2`,
				`risk3`,
				`risk4`,
				`risk5`,
				`risk6`,
				`risk7`,
				`risk8`,
				`risk9`,
				`risk10`,
				`risk11`,
				`risk12`,
				`risk13`,
				`risk14`,
				`risk15`,
				`totalrisk`,
				`created`,
				`lastUpdated`)
			SELECT 
				`user_risk_questions`.`acctnum`,
				`user_risk_questions`.`investmentgoal`,
				`user_risk_questions`.`age`,
				`user_risk_questions`.`retireage`,
				`user_risk_questions`.`retired`,
				`user_risk_questions`.`horizon`,
				`user_risk_questions`.`ans1`,
				`user_risk_questions`.`ans2`,
				`user_risk_questions`.`ans3`,
				`user_risk_questions`.`ans4`,
				`user_risk_questions`.`ans5`,
				`user_risk_questions`.`ans6`,
				`user_risk_questions`.`ans7`,
				`user_risk_questions`.`ans8`,
				`user_risk_questions`.`ans9`,
				`user_risk_questions`.`ans10`,
				`user_risk_questions`.`ans11`,
				`user_risk_questions`.`ans12`,
				`user_risk_questions`.`ans13`,
				`user_risk_questions`.`ans14`,
				`user_risk_questions`.`ans15`,
				`user_risk_questions`.`formula`,
				`user_risk_questions`.`risk1`,
				`user_risk_questions`.`risk2`,
				`user_risk_questions`.`risk3`,
				`user_risk_questions`.`risk4`,
				`user_risk_questions`.`risk5`,
				`user_risk_questions`.`risk6`,
				`user_risk_questions`.`risk7`,
				`user_risk_questions`.`risk8`,
				`user_risk_questions`.`risk9`,
				`user_risk_questions`.`risk10`,
				`user_risk_questions`.`risk11`,
				`user_risk_questions`.`risk12`,
				`user_risk_questions`.`risk13`,
				`user_risk_questions`.`risk14`,
				`user_risk_questions`.`risk15`,
				`user_risk_questions`.`totalrisk`,
				`user_risk_questions`.`created`,
				`user_risk_questions`.`lastUpdated`
		FROM `invdb`.`user_risk_questions`
        WHERE `user_risk_questions`.`acctnum` = p_acctnum;
    END;
    
    BEGIN
    
		INSERT INTO `invdbaudit`.`acct_financial`
			(
			`acctnum`,
			`dependent`,
			`estdDependentExpense`,
			`householdwages`,
			`otherincome`,
			`bonusincome`,
			`interestincome`,
			`dividentincome`,
			`rentalIncome`,
			`totalIncome`,
			`totalIncomeAnnulized`,
			`householdPayment`,
			`otherPropertiesPayment`,
			`automobilePayment`,
			`medicalPayment`,
			`federaltaxes`,
			`stateTaxes`,
			`propertyTax`,
			`otherPropertyTax`,
			`homeInsurance`,
			`lifeInsurance`,
			`autoInsurance`,
			`educationPayment`,
			`creditCardPayment`,
			`miscExpenses`,
			`totalExpense`,
			`totalExpenseAnnulized`,
			`homeEquity`,
			`autoValue`,
			`moneyMarket`,
			`checkingAcct`,
			`savingAcct`,
			`investment`,
			`equityOtherProperties`,
			`retirementInvestement`,
			`miscInvestment`,
			`totalAsset`,
			`mortgageLoan`,
			`autoLoan`,
			`educationLoan`,
			`creditCardDebt`,
			`otherPropertiesLoan`,
			`medicalDebt`,
			`otherDebt`,
			`totalDebt`,
			`liquidnetworth`,
			`networth`,
			`created`,
			`lastupdated`)
		SELECT 
			`acct_financial`.`acctnum`,
			`acct_financial`.`dependent`,
			`acct_financial`.`estdDependentExpense`,
			`acct_financial`.`householdwages`,
			`acct_financial`.`otherincome`,
			`acct_financial`.`bonusincome`,
			`acct_financial`.`interestincome`,
			`acct_financial`.`dividentincome`,
			`acct_financial`.`rentalIncome`,
			`acct_financial`.`totalIncome`,
			`acct_financial`.`totalIncomeAnnulized`,
			`acct_financial`.`householdPayment`,
			`acct_financial`.`otherPropertiesPayment`,
			`acct_financial`.`automobilePayment`,
			`acct_financial`.`medicalPayment`,
			`acct_financial`.`federaltaxes`,
			`acct_financial`.`stateTaxes`,
			`acct_financial`.`propertyTax`,
			`acct_financial`.`otherPropertyTax`,
			`acct_financial`.`homeInsurance`,
			`acct_financial`.`lifeInsurance`,
			`acct_financial`.`autoInsurance`,
			`acct_financial`.`educationPayment`,
			`acct_financial`.`creditCardPayment`,
			`acct_financial`.`miscExpenses`,
			`acct_financial`.`totalExpense`,
			`acct_financial`.`totalExpenseAnnulized`,
			`acct_financial`.`homeEquity`,
			`acct_financial`.`autoValue`,
			`acct_financial`.`moneyMarket`,
			`acct_financial`.`checkingAcct`,
			`acct_financial`.`savingAcct`,
			`acct_financial`.`investment`,
			`acct_financial`.`equityOtherProperties`,
			`acct_financial`.`retirementInvestement`,
			`acct_financial`.`miscInvestment`,
			`acct_financial`.`totalAsset`,
			`acct_financial`.`mortgageLoan`,
			`acct_financial`.`autoLoan`,
			`acct_financial`.`educationLoan`,
			`acct_financial`.`creditCardDebt`,
			`acct_financial`.`otherPropertiesLoan`,
			`acct_financial`.`medicalDebt`,
			`acct_financial`.`otherDebt`,
			`acct_financial`.`totalDebt`,
			`acct_financial`.`liquidnetworth`,
			`acct_financial`.`networth`,
			`acct_financial`.`created`,
			`acct_financial`.`lastupdated`
		FROM `invdb`.`acct_financial`
		WHERE `acct_financial`.`acctnum` = p_acctnum;

    END;
    
    BEGIN
    
		INSERT INTO `invdbaudit`.`asset_alloc`
		(
			`acctnum`,
			`assetclass`,
			`themecode`,
			`allocationmodel`,
			`assetyear`,
			`active`,
			`sortnum`,
			`weight`,
			`created`,
			`lastupdated`
        )
		SELECT 
			`asset_alloc`.`acctnum`,
			`asset_alloc`.`assetclass`,
			`asset_alloc`.`themecode`,
			`asset_alloc`.`allocationmodel`,
			`asset_alloc`.`assetyear`,
			`asset_alloc`.`active`,
			`asset_alloc`.`sortnum`,
			`asset_alloc`.`weight`,
			`asset_alloc`.`created`,
			`asset_alloc`.`lastupdated`
		FROM `invdbaudit`.`asset_alloc`
        WHERE `asset_alloc`.`acctnum` = p_acctnum;
    END;
    
    BEGIN
		INSERT INTO `invdbaudit`.`virtual_portfolio`
		(
			`acctnum`,
			`itemnum`,
			`instrumentid`,
			`ticker`,
			`active`,
			`qty`,
			`weight`,
			`tradeprice`,
			`investmentvalue`,
			`created`,
			`lastupdated`
		)
		SELECT 
			`virtual_portfolio`.`acctnum`,
			`virtual_portfolio`.`itemnum`,
			`virtual_portfolio`.`instrumentid`,
			`virtual_portfolio`.`ticker`,
			`virtual_portfolio`.`active`,
			`virtual_portfolio`.`qty`,
			`virtual_portfolio`.`weight`,
			`virtual_portfolio`.`tradeprice`,
			`virtual_portfolio`.`investmentvalue`,
			`virtual_portfolio`.`created`,
			`virtual_portfolio`.`lastupdated`
		FROM `invdbaudit`.`virtual_portfolio`
		WHERE `virtual_portfolio`.`acctnum` = p_acctnum;
    END;
    
END$$
DELIMITER ;
