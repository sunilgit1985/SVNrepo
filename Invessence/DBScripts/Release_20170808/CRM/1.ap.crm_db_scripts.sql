INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', '16E6A8B3-4515-4BF0-AEFC-05D5B33A7EEB', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'http://dev.api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', '16E6A8B3-4515-4BF0-AEFC-05D5B33A7EEB', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'http://dev.api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', 'E877C2A5-B51D-4651-8BE1-89BAEF4B3F99', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'https://api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'BUILDINGBENJAMINS', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');

INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', '16E6A8B3-4515-4BF0-AEFC-05D5B33A7EEB', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'http://dev.api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', '16E6A8B3-4515-4BF0-AEFC-05D5B33A7EEB', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'http://dev.api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', 'E877C2A5-B51D-4651-8BE1-89BAEF4B3F99', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'https://api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'TCM', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');


INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', '16E6A8B3-4515-4BF0-AEFC-05D5B33A7EEB', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'http://dev.api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('DEV', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', '16E6A8B3-4515-4BF0-AEFC-05D5B33A7EEB', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'http://dev.api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('UAT', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'API_KEY', 'E877C2A5-B51D-4651-8BE1-89BAEF4B3F99', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'BASE_URL', 'https://api2.redtailtechnology.com/crm/v1/rest', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'AUTHENTICATION_URL', '/authentication', 'N');
INSERT INTO `service`.`service_config_details` (`mode`, `company`, `service`, `vendor`, `name`, `value`, `encrFlag`) VALUES ('PROD', 'UOB', 'CRM-SERVICES', 'REDTAIL', 'SSO_URL', '/sso?ep=dashboard', 'N');



INSERT INTO `service`.`service_master` (`company`, `service`, `status`, `vendor`) VALUES ('BUILDINGBENJAMINS', 'CRM-SERVICES', 'A', 'REDTAIL');
INSERT INTO `service`.`service_master` (`company`, `service`, `status`, `vendor`) VALUES ('UOB', 'CRM-SERVICES', 'A', 'REDTAIL');
INSERT INTO `service`.`service_master` (`company`, `service`, `status`, `vendor`) VALUES ('TCM', 'CRM-SERVICES', 'A', 'REDTAIL');


INSERT INTO `invdb`.`web_site_info` (`url`, `name`, `status`, `value`, `encrFlag`, `created`) VALUES ('localhost:8084', 'SERVICE.CRM.MODE', 'A', 'UAT', 'N', '2017-08-03 19:56:55');

CREATE TABLE `invdb`.`crm_user_logon` (
  `logonid` bigint(20) NOT NULL,
  `userid` varchar(100) NOT NULL,
  `pwd` varchar(50) NOT NULL,
  `email` varchar(100) NOT NULL,
  `userKey` varchar(100) NOT NULL,
  `status` varchar(10) DEFAULT NULL,
  `created` datetime NOT NULL,
  `createdby` bigint(20) NOT NULL,
  `updated` datetime DEFAULT NULL,
  `updatedby` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`logonid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

USE `invdb`;
CREATE 
     OR REPLACE ALGORITHM = UNDEFINED 
    SQL SECURITY DEFINER
VIEW `vwcrm_user_details` AS
    SELECT 
        `ul`.`logonid` AS `logonid`,
        `cul`.`userid` AS `crmUserId`,
        `cul`.`pwd` AS `crmPwd`,
        `cul`.`status` AS `crmStatus`,
        `cul`.`userKey` AS `crmUserKey`,
        `ul`.`userid` AS `userid`,
        `ul`.`logonstatus` AS `logonstatus`,
        `ul`.`prefix` AS `prefix`,
        `ul`.`lastname` AS `lastname`,
        `ul`.`firstname` AS `firstname`,
        `ul`.`middlename` AS `middlename`,
        `ul`.`suffix` AS `suffix`,
        `ul`.`email` AS `email`
    FROM
        (`user_logon` `ul`
        LEFT JOIN `crm_user_logon` `cul` ON ((`ul`.`logonid` = `cul`.`logonid`)));



USE `invdb`;
DROP procedure IF EXISTS `spcrm_user_mgmt`;

DELIMITER $$
USE `invdb`$$
CREATE  PROCEDURE `spcrm_user_mgmt`(in p_logonid numeric(10), 
in p_userid varchar(100), 
in p_pwd varchar(100), 
in p_email varchar(100), 
in p_userkey varchar(100),
in p_status varchar(1), 
in p_created datetime, 
in p_createdby varchar(100),
in p_opt varchar(20), 
out op_msgCode int(3),out op_msg varchar(20))
BEGIN
DECLARE r_count INTEGER;

select count(1) into r_count from crm_user_logon where logonid=p_logonid; 
	if(r_count>0)then
		update crm_user_logon set
        userid=p_userid,
		pwd=p_pwd, email=p_email, 
        userKey= p_userkey,
		-- status=p_status, 
		updated=p_created, 
		updatedby=p_createdby
		where logonid=p_logonid;
		
	else
		Insert into crm_user_logon(logonid, userid, pwd, email, userKey,  status, created, createdby) 
		value(p_logonid, p_userid, p_pwd, p_email, p_userkey, 'A', p_created, p_createdby);  

	end if;    
		SELECT p_opt, 1 INTO op_msg , op_msgCode;
    
END$$

DELIMITER ;




INSERT INTO `invdb`.`web_menu` (`url`, `access`, `permission`, `label`, `level`, `sublevel`, `seq`, `status`, `availOnMobile`, `destdir`, `htmlpage`, `created`) VALUES ('master', 'Advisor', 'CRM', 'RedTail', '0', '0', '7', 'A', 'N', 'advisor', 'assetworkflow.xhtml', '2017-08-04 04:01:55');
INSERT INTO `invdb`.`web_menu` (`url`, `access`, `permission`, `label`, `level`, `sublevel`, `seq`, `status`, `availOnMobile`, `destdir`, `htmlpage`, `created`) VALUES ('master', 'Advisor', 'CRM', 'SalesFource', '0', '0', '3', 'N', 'N', 'advisor/operations', 'trade.xhtml', '2017-08-04 04:01:55');


